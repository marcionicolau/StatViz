pairwise.wilcox.test.with.statistic <- function (x, g, p.adjust.method = p.adjust.methods, paired = FALSE,     ...) {    p.adjust.method <- match.arg(p.adjust.method)    DNAME <- paste(deparse(substitute(x)), "and", deparse(substitute(g)))    g <- factor(g)    METHOD <- if (paired)         "Wilcoxon signed rank test"    else "Wilcoxon rank sum test"    compare.levels <- function(i, j) {        xi <- x[as.integer(g) == i]        xj <- x[as.integer(g) == j]        wilcox.test(xi, xj, paired = paired, ...)$p.value    }        compare.levels.with.statistic <- function(i, j) {        xi <- x[as.integer(g) == i]        xj <- x[as.integer(g) == j]        if(paired == FALSE)            wilcox.test(xi, xj, paired = paired, ...)$statistic[["W"]]        else            wilcox.test(xi, xj, paired = paired, ...)$statistic[["V"]]    }    PVAL <- pairwise.table(compare.levels, levels(g), p.adjust.method)        UVAL <- pairwise.table.with.statistic(compare.levels.with.statistic, levels(g), p.adjust.method)    ans <- list(method = METHOD, data.name = DNAME, p.value = PVAL,         p.adjust.method = p.adjust.method, U=UVAL)    class(ans) <- "pairwise.htest"    ans}